$testerDirectory = "C:\Users\tmg\OneDrive - VENZO GROUP\---- PERSONAL\MDEtester-main\Tools"
$dateSuffix = Get-Date -Format "yyyyMMddHHmm"
$outputFileName = "MDE-Test-Log-$dateSuffix.txt"

# Check SmartScreen Status
function Check-SmartScreenStatus {
    try {
        $status = Get-ItemPropertyValue "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name SmartScreenEnabled -ErrorAction Stop
        if ($status -eq "Off") {
            Write-Host "SmartScreen is disabled."
        } else {
            Write-Host "SmartScreen is enabled."
        }
    } catch {
        Write-Host "Unable to determine SmartScreen status. It might be configured differently on this system."
    }
}

# Function to test URLs with SmartScreen
function Test-SmartScreenUrl {
    param (
        [string]$url,
        [string]$message
    )
    Write-Host "Opening $message"
    Start-Process msedge -ArgumentList $url
}

# Main
Check-SmartScreenStatus

# Test URLs
Test-SmartScreenUrl -url "https://demo.smartscreen.msft.net/phishingdemo.html" -message "Phishing URL"
Test-SmartScreenUrl -url "https://demo.smartscreen.msft.net/other/malware.html" -message "Malware URL"
Test-SmartScreenUrl -url "https://demo.smartscreen.msft.net/download/malwaredemo/freevideo.exe" -message "Untrusted URL"
Test-SmartScreenUrl -url "https://demo.smartscreen.msft.net/other/exploit.html" -message "Exploit URL"